{"ast":null,"code":"// Group transactions by ISIN and calculate aggregated data for Buy/Sell\nimport axios from \"axios\";\nasync function getStockPrice(date, symbol, ticker = \"NSE\") {\n  try {\n    let d = date.split(\"/\"); //.reverse();\n    if (d[1].length === 1) {\n      d[1] = \"0\" + d[1];\n    }\n    if (d[2].length === 1) {\n      d[2] = \"0\" + d[2];\n    }\n    d = d.join(\"-\");\n    console.log(d);\n    const data = await axios.get(`https://eodhd.com/api/eod/${symbol}.${ticker}?from=${d}&to=${d}&api_token=673b87984c1849.71141183&fmt=json`);\n    return data[\"data\"][0][\"close\"];\n  } catch (err) {\n    console.log(err.message);\n  }\n}\nexport function groupByISIN(transactions, type) {\n  const filtered = transactions.filter(t => t.type === type);\n  return Object.values(filtered);\n}\n\n// Calculate FIFO-based Realized Profit and Loss\nexport function calculateFIFORealizedPnL(transactions) {\n  const buys = {}; // Tracks remaining buys for each ISIN\n  const realized = []; // Stores profit/loss for each sell transaction\n\n  transactions.forEach(t => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({\n        quantity: t.quantity,\n        cost: t.totalCost\n      });\n    } else if (t.type === \"Sell\") {\n      let sellQuantity = t.quantity;\n      let sellValue = Number(t.totalCost);\n      let buyCost = 0;\n\n      // Process sell in FIFO order\n      while (sellQuantity > 0 && ((_buys$t$ISIN = buys[t.ISIN]) === null || _buys$t$ISIN === void 0 ? void 0 : _buys$t$ISIN.length) > 0) {\n        var _buys$t$ISIN;\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n        buyCost += usedQuantity / buy.quantity * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift(); // Remove the fully used buy\n        }\n      }\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit\n      });\n    }\n  });\n  return realized;\n}\n\n// Calculate current holdings after all Buy and Sell transactions\nexport function calculateHoldings(transactions) {\n  const holdings = {};\n  transactions.forEach(t => {\n    if (!holdings[t.ISIN]) {\n      holdings[t.ISIN] = {\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        quantity: 0\n      };\n    }\n    holdings[t.ISIN].quantity += t.type === \"Buy\" ? t.quantity : -t.quantity;\n  });\n\n  // Filter stocks with positive quantity only\n  return Object.values(holdings).filter(h => h.quantity > 0);\n}\n\n// Calculate FIFO-based Realized Profit and Loss and Update Holdings\nexport function calculateFIFOAndHoldings(transactions) {\n  const buys = {}; // Tracks remaining buy quantities and costs for each ISIN\n  const realized = [];\n  const holdings = {};\n  transactions.forEach(t => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({\n        quantity: t.quantity,\n        cost: t.totalCost,\n        date: t.date\n      });\n      if (!holdings[t.ISIN]) {\n        holdings[t.ISIN] = {\n          ISIN: t.ISIN,\n          stockName: t.stockName,\n          quantity: 0,\n          totalCost: 0,\n          avgCost: 0\n        };\n      }\n      holdings[t.ISIN].quantity += t.quantity;\n      holdings[t.ISIN].totalCost += Number(t.totalCost); // Ensure totalCost is a number\n      holdings[t.ISIN].avgCost = holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n    } else if (t.type === \"Sell\") {\n      // Sell logic remains the same\n      let sellQuantity = +t.quantity;\n      let sellValue = +t.totalCost;\n      let buyCost = 0;\n      while (sellQuantity > 0 && ((_buys$t$ISIN2 = buys[t.ISIN]) === null || _buys$t$ISIN2 === void 0 ? void 0 : _buys$t$ISIN2.length) > 0) {\n        var _buys$t$ISIN2;\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n        buyCost += usedQuantity / buy.quantity * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift();\n        }\n      }\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit,\n        date: t.date\n      });\n      if (holdings[t.ISIN]) {\n        holdings[t.ISIN].quantity -= t.quantity;\n        holdings[t.ISIN].totalCost -= buyCost;\n        if (holdings[t.ISIN].quantity === 0) {\n          delete holdings[t.ISIN];\n        } else {\n          holdings[t.ISIN].avgCost = holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n        }\n      }\n    }\n  });\n  return {\n    holdings: Object.values(holdings),\n    realized\n  };\n}\n\n// Calculate Day-to-Day CAGR for each transaction and compute Portfolio CAGR\nexport async function calculateCAGRAndPortfolio(transactions) {\n  const buys = {}; // Track remaining buy quantities and costs\n  const realized = [];\n  const holdings = {};\n  const cagrList = []; // List to store individual CAGRs for portfolio CAGR calculation\n\n  transactions.forEach(t => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({\n        quantity: +t.quantity,\n        cost: +t.totalCost,\n        date: t.date\n      });\n      if (!holdings[t.ISIN]) {\n        holdings[t.ISIN] = {\n          ISIN: t.ISIN,\n          stockName: t.stockName,\n          quantity: 0,\n          totalCost: 0,\n          avgCost: 0,\n          startDate: t.date,\n          // Save the start date of the stock purchase\n          endDate: null // Will update after sell\n        };\n      }\n      holdings[t.ISIN].quantity += Number(t.quantity);\n      holdings[t.ISIN].totalCost += Number(t.totalCost);\n      holdings[t.ISIN].avgCost = holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n    } else if (t.type === \"Sell\") {\n      let sellQuantity = +t.quantity;\n      let sellValue = +t.totalCost;\n      let buyCost = 0;\n      while (sellQuantity > 0 && ((_buys$t$ISIN3 = buys[t.ISIN]) === null || _buys$t$ISIN3 === void 0 ? void 0 : _buys$t$ISIN3.length) > 0) {\n        var _buys$t$ISIN3;\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n        buyCost += usedQuantity / buy.quantity * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift();\n        }\n      }\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit,\n        date: t.date\n      });\n\n      // Update holdings\n      if (holdings[t.ISIN]) {\n        holdings[t.ISIN].quantity -= +t.quantity;\n        holdings[t.ISIN].totalCost -= +buyCost;\n        holdings[t.ISIN].endDate = t.date; // Set end date after sell\n\n        if (holdings[t.ISIN].quantity === 0) {\n          delete holdings[t.ISIN];\n        } else {\n          holdings[t.ISIN].avgCost = holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n        }\n      }\n    }\n  });\n\n  // Calculate Day-to-Day CAGR for Holdings\n  Object.values(holdings).forEach(h => {\n    const startDate = new Date(h.startDate);\n    const endDate = new Date(h.endDate || new Date());\n    const daysHeld = (endDate - startDate) / (1000 * 3600 * 24); // Calculate days\n    const cagr = Math.pow(h.totalCost / (h.totalCost - h.totalCost), 1 / daysHeld) - 1; // Replace this logic to handle daily calculations better\n    cagrList.push(cagr);\n    h.dayToDayCAGR = cagr.toFixed(4); // Adding the Day-to-Day CAGR to holdings\n  });\n\n  // Portfolio CAGR (RMS of individual CAGRs)\n  const portfolioCAGR = Math.sqrt(cagrList.reduce((acc, c) => acc + Math.pow(c, 2), 0) / cagrList.length);\n  return {\n    holdings: Object.values(holdings),\n    realized,\n    portfolioCAGR\n  };\n}","map":{"version":3,"names":["axios","getStockPrice","date","symbol","ticker","d","split","length","join","console","log","data","get","err","message","groupByISIN","transactions","type","filtered","filter","t","Object","values","calculateFIFORealizedPnL","buys","realized","forEach","ISIN","push","quantity","cost","totalCost","sellQuantity","sellValue","Number","buyCost","_buys$t$ISIN","buy","usedQuantity","Math","min","shift","profit","stockName","calculateHoldings","holdings","h","calculateFIFOAndHoldings","avgCost","_buys$t$ISIN2","calculateCAGRAndPortfolio","cagrList","startDate","endDate","_buys$t$ISIN3","Date","daysHeld","cagr","pow","dayToDayCAGR","toFixed","portfolioCAGR","sqrt","reduce","acc","c"],"sources":["/Users/rusher/Portfolio-Management/excel-utility/src/utils/helpers.js"],"sourcesContent":["// Group transactions by ISIN and calculate aggregated data for Buy/Sell\nimport axios from \"axios\";\n\nasync function getStockPrice(date, symbol, ticker = \"NSE\") {\n  try {\n    let d = date.split(\"/\"); //.reverse();\n    if (d[1].length === 1) {\n      d[1] = \"0\" + d[1];\n    }\n    if (d[2].length === 1) {\n      d[2] = \"0\" + d[2];\n    }\n    d = d.join(\"-\");\n    console.log(d);\n    const data = await axios.get(\n      `https://eodhd.com/api/eod/${symbol}.${ticker}?from=${d}&to=${d}&api_token=673b87984c1849.71141183&fmt=json`\n    );\n\n    return data[\"data\"][0][\"close\"];\n  } catch (err) {\n    console.log(err.message);\n  }\n}\n\nexport function groupByISIN(transactions, type) {\n  const filtered = transactions.filter((t) => t.type === type);\n\n  return Object.values(filtered);\n}\n\n// Calculate FIFO-based Realized Profit and Loss\nexport function calculateFIFORealizedPnL(transactions) {\n  const buys = {}; // Tracks remaining buys for each ISIN\n  const realized = []; // Stores profit/loss for each sell transaction\n\n  transactions.forEach((t) => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({ quantity: t.quantity, cost: t.totalCost });\n    } else if (t.type === \"Sell\") {\n      let sellQuantity = t.quantity;\n      let sellValue = Number(t.totalCost);\n      let buyCost = 0;\n\n      // Process sell in FIFO order\n      while (sellQuantity > 0 && buys[t.ISIN]?.length > 0) {\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n\n        buyCost += (usedQuantity / buy.quantity) * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift(); // Remove the fully used buy\n        }\n      }\n\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit,\n      });\n    }\n  });\n\n  return realized;\n}\n\n// Calculate current holdings after all Buy and Sell transactions\nexport function calculateHoldings(transactions) {\n  const holdings = {};\n\n  transactions.forEach((t) => {\n    if (!holdings[t.ISIN]) {\n      holdings[t.ISIN] = { ISIN: t.ISIN, stockName: t.stockName, quantity: 0 };\n    }\n    holdings[t.ISIN].quantity += t.type === \"Buy\" ? t.quantity : -t.quantity;\n  });\n\n  // Filter stocks with positive quantity only\n  return Object.values(holdings).filter((h) => h.quantity > 0);\n}\n\n// Calculate FIFO-based Realized Profit and Loss and Update Holdings\nexport function calculateFIFOAndHoldings(transactions) {\n  const buys = {}; // Tracks remaining buy quantities and costs for each ISIN\n  const realized = [];\n  const holdings = {};\n\n  transactions.forEach((t) => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({\n        quantity: t.quantity,\n        cost: t.totalCost,\n        date: t.date,\n      });\n\n      if (!holdings[t.ISIN]) {\n        holdings[t.ISIN] = {\n          ISIN: t.ISIN,\n          stockName: t.stockName,\n          quantity: 0,\n          totalCost: 0,\n          avgCost: 0,\n        };\n      }\n      holdings[t.ISIN].quantity += t.quantity;\n      holdings[t.ISIN].totalCost += Number(t.totalCost); // Ensure totalCost is a number\n      holdings[t.ISIN].avgCost =\n        holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n    } else if (t.type === \"Sell\") {\n      // Sell logic remains the same\n      let sellQuantity = +t.quantity;\n      let sellValue = +t.totalCost;\n      let buyCost = 0;\n\n      while (sellQuantity > 0 && buys[t.ISIN]?.length > 0) {\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n\n        buyCost += (usedQuantity / buy.quantity) * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift();\n        }\n      }\n\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit,\n        date: t.date,\n      });\n\n      if (holdings[t.ISIN]) {\n        holdings[t.ISIN].quantity -= t.quantity;\n        holdings[t.ISIN].totalCost -= buyCost;\n\n        if (holdings[t.ISIN].quantity === 0) {\n          delete holdings[t.ISIN];\n        } else {\n          holdings[t.ISIN].avgCost =\n            holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n        }\n      }\n    }\n  });\n\n  return { holdings: Object.values(holdings), realized };\n}\n\n// Calculate Day-to-Day CAGR for each transaction and compute Portfolio CAGR\nexport async function calculateCAGRAndPortfolio(transactions) {\n  const buys = {}; // Track remaining buy quantities and costs\n  const realized = [];\n  const holdings = {};\n  const cagrList = []; // List to store individual CAGRs for portfolio CAGR calculation\n\n  transactions.forEach((t) => {\n    if (t.type === \"Buy\") {\n      if (!buys[t.ISIN]) buys[t.ISIN] = [];\n      buys[t.ISIN].push({\n        quantity: +t.quantity,\n        cost: +t.totalCost,\n        date: t.date,\n      });\n\n      if (!holdings[t.ISIN]) {\n        holdings[t.ISIN] = {\n          ISIN: t.ISIN,\n          stockName: t.stockName,\n          quantity: 0,\n          totalCost: 0,\n          avgCost: 0,\n          startDate: t.date, // Save the start date of the stock purchase\n          endDate: null, // Will update after sell\n        };\n      }\n\n      holdings[t.ISIN].quantity += Number(t.quantity);\n      holdings[t.ISIN].totalCost += Number(t.totalCost);\n      holdings[t.ISIN].avgCost =\n        holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n    } else if (t.type === \"Sell\") {\n      let sellQuantity = +t.quantity;\n      let sellValue = +t.totalCost;\n      let buyCost = 0;\n\n      while (sellQuantity > 0 && buys[t.ISIN]?.length > 0) {\n        const buy = buys[t.ISIN][0];\n        const usedQuantity = Math.min(sellQuantity, buy.quantity);\n\n        buyCost += (usedQuantity / buy.quantity) * buy.cost;\n        buy.quantity -= usedQuantity;\n        sellQuantity -= usedQuantity;\n\n        if (buy.quantity === 0) {\n          buys[t.ISIN].shift();\n        }\n      }\n\n      const profit = sellValue - buyCost;\n      realized.push({\n        ISIN: t.ISIN,\n        stockName: t.stockName,\n        sellQuantity: t.quantity,\n        sellValue,\n        buyCost,\n        profit,\n        date: t.date,\n      });\n\n      // Update holdings\n      if (holdings[t.ISIN]) {\n        holdings[t.ISIN].quantity -= +t.quantity;\n        holdings[t.ISIN].totalCost -= +buyCost;\n        holdings[t.ISIN].endDate = t.date; // Set end date after sell\n\n        if (holdings[t.ISIN].quantity === 0) {\n          delete holdings[t.ISIN];\n        } else {\n          holdings[t.ISIN].avgCost =\n            holdings[t.ISIN].totalCost / holdings[t.ISIN].quantity;\n        }\n      }\n    }\n  });\n\n  // Calculate Day-to-Day CAGR for Holdings\n  Object.values(holdings).forEach((h) => {\n    const startDate = new Date(h.startDate);\n    const endDate = new Date(h.endDate || new Date());\n    const daysHeld = (endDate - startDate) / (1000 * 3600 * 24); // Calculate days\n    const cagr =\n      Math.pow(h.totalCost / (h.totalCost - h.totalCost), 1 / daysHeld) - 1; // Replace this logic to handle daily calculations better\n    cagrList.push(cagr);\n    h.dayToDayCAGR = cagr.toFixed(4); // Adding the Day-to-Day CAGR to holdings\n  });\n\n  // Portfolio CAGR (RMS of individual CAGRs)\n  const portfolioCAGR = Math.sqrt(\n    cagrList.reduce((acc, c) => acc + Math.pow(c, 2), 0) / cagrList.length\n  );\n\n  return { holdings: Object.values(holdings), realized, portfolioCAGR };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}